<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
	<title>OSS 签名生成</title>
	<link rel="stylesheet" type="text/css" href="style.css"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<script type="text/javascript" src="lib/crypto1/crypto/crypto.js"></script>
	<script type="text/javascript" src="lib/crypto1/hmac/hmac.js"></script>
	<script type="text/javascript" src="lib/crypto1/sha1/sha1.js"></script>
	<script type="text/javascript" src="lib/base64.js"></script>
	<script type="text/javascript">
	function makeSign(){
		var accessid = document.getElementById("id").value;
		var accesskey = document.getElementById("key").value;
		var host = document.getElementById("host").value;
		var result = document.getElementById("result");
	
		if(!accessid || accessid == ""){
			alert("accessid 不能为空");
			return;
		}
		
		if(!accesskey || accesskey == ""){
			alert("accesskey 不能为空");
			return;
		}
		
		if(!host || host == ""){
			alert("endpoint 不能为空");
			return;
		}
		
		var now = timestamp = Date.parse(new Date()) / 1000; 
		var policyText = {"expiration":"2020-01-01T12:00:00.000Z","conditions":[["content-length-range", 0,1048576000]]};
		var policyBase64 = Base64.encode(JSON.stringify(policyText))
		message = policyBase64;
		var bytes = Crypto.HMAC(Crypto.SHA1, message, accesskey, { asBytes: true }) ;
		var signature = Crypto.util.bytesToBase64(bytes);
		result.value = signature;
	}
</script>
</head>
<body>
<h2>OSS签名计算</h2>
<br>
<table>
<tr>
<td>accessid:</td>
<td><input id="id" type="text" size="120" placeholder="AqxWHDh58yaacTNj1"></td>
</tr>

<tr>
<td>accesskey:</td>
<td><input id="key" type="text" size="120" placeholder="DLtzO65ImbAYoTtTgM91NvtVPKEfIBf"></td>
</tr>

<tr>
<td>endpoint:</td>
<td><input id="host" type="text" size="120" placeholder="http://doolandpep3.oss-cn-shenzhen.aliyuncs.com"></td>
</tr>

<tr>
<td>签名:</td>
<td><input id="result" type="text" size="120" readonly></td>
</tr>
</table>
<tr><button onclick="makeSign();">生成</button></tr>
</body>
</html>
